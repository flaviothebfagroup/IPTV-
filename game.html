<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Most Likely — Spicy Edition</title>
<style>
  :root{
    --bg:#07080a; --grad1:#111827; --grad2:#0b0f1a;
    --panel:#121318; --tile:#191a20; --fg:#fff; --muted:#b7bcc7;
    --border:rgba(255,255,255,.14); --accent:#ff5d8f; --accent2:#ffb703; --ok:#22c55e;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--fg); background:
      radial-gradient(1200px 800px at 80% -10%, #1e1b4b 0%, transparent 60%),
      radial-gradient(900px 600px at 10% 110%, #4c1d95 0%, transparent 60%),
      linear-gradient(180deg,var(--grad1),var(--grad2));
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }
  .app{max-width:980px; margin:0 auto; padding:18px 16px 80px}
  header{display:flex; align-items:center; gap:12px; padding:6px 6px 16px}
  .logo{
    width:40px;height:40px;border-radius:12px;
    background: conic-gradient(from 210deg,#ff5d8f,#ffb703,#7c3aed,#ff5d8f);
    display:grid;place-items:center;color:#0b0b0c;font-weight:900;letter-spacing:.4px;
  }
  h1{font-size:22px; margin:0}
  .tiny{font-size:12px;color:var(--muted)}
  .panel{
    background: color-mix(in srgb, var(--panel) 90%, black 10%);
    border:1px solid var(--border); border-radius:18px; padding:18px;
    box-shadow: 0 30px 80px rgba(0,0,0,.45);
    backdrop-filter: blur(10px);
  }
  .grid{display:grid; gap:14px}
  @media(min-width:760px){ .grid.two{grid-template-columns:1fr 1fr} }
  .title{font-size:20px;font-weight:800; letter-spacing:.2px}
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  input,button,select,label.toggle{
    border-radius:14px; border:1px solid var(--border);
    background:var(--tile); color:var(--fg);
  }
  input,select{padding:14px 14px; font-size:18px; min-height:52px}
  input::placeholder{color:#8e93a3}
  button{
    padding:14px 16px; font-size:18px; cursor:pointer; border-color:transparent;
    background:linear-gradient(180deg,#23242c,#181a20); font-weight:700;
  }
  button.primary{
    background:linear-gradient(180deg,#ff8ab1,#ff5d8f);
    color:#1a0f13; border:1px solid rgba(255,255,255,.18);
    text-shadow:0 1px 0 rgba(255,255,255,.35)
  }
  button.warn{background:linear-gradient(180deg,#ffd166,#ffb703); color:#201607}
  button.ghost{background:transparent; border:1px dashed var(--border); color:var(--muted)}
  .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
  .chip{background:#23242c; border:1px solid var(--border); padding:10px 12px; border-radius:999px; display:flex; gap:8px; align-items:center; font-size:16px}
  .chip button{background:transparent; border:none; color:#9aa0ad; padding:0 2px; font-size:18px; cursor:pointer}
  .sep{height:1px;background:var(--border); margin:12px 0}
  label.toggle{
    display:inline-flex; gap:10px; align-items:center; padding:10px 12px; color:#d0d5e1; background:#1a1b22;
  }
  .note{font-size:13px; color:#9aa0ad}
  .big{font-size:22px}
  /* Round UI */
  .story{font-size:20px; line-height:1.45; background:#1a1b22; border:1px solid var(--border); border-radius:16px; padding:14px}
  .question{font-size:22px; font-weight:800; margin-top:10px}
  .players{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:14px}
  @media(min-width:560px){ .players{grid-template-columns:1fr 1fr 1fr} }
  .pbtn{
    min-height:64px; font-size:20px; padding:16px; border-radius:14px; border:1px solid var(--border);
    background:linear-gradient(180deg,#21232a,#17181f); display:flex; justify-content:space-between; align-items:center;
  }
  .pbtn small{color:#a8aebd; font-weight:600; font-size:16px}
  .toolbar{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
  .winner{
    padding:14px; border-radius:14px; background:linear-gradient(180deg, rgba(34,197,94,.2), rgba(34,197,94,.06));
    border:1px solid rgba(34,197,94,.35); font-size:18px
  }
  .scoreboard{margin-top:14px; border-top:1px solid var(--border); padding-top:14px}
  .scores{display:grid; grid-template-columns:1fr 1fr; gap:10px}
  @media(min-width:680px){ .scores{grid-template-columns:1fr 1fr 1fr 1fr} }
  .score{background:#1a1b22; border:1px solid var(--border); border-radius:12px; padding:10px 12px; display:flex; justify-content:space-between; font-size:18px}
  .hidden{display:none !important}
  .confetti{pointer-events:none; position:fixed; inset:0; overflow:hidden}
  .confetti i{position:absolute; width:10px; height:14px; border-radius:2px; opacity:.9}
  /* Accessibility helpers */
  .xl *{font-size: calc(1.12 * 1rem)}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">🔥</div>
    <div>
      <h1>Most Likely — Spicy Edition</h1>
      <div class="tiny">Bigger buttons • High contrast • Chill / Spicy / 18+ decks</div>
    </div>
  </header>

  <!-- SETUP -->
  <section id="setup" class="panel grid two">
    <div>
      <div class="title">Players</div>
      <div class="row" style="margin-top:8px;">
        <input id="nameInput" type="text" placeholder="Type a name and press Add" onkeydown="if(event.key==='Enter') addPlayer()">
        <button class="primary" onclick="addPlayer()">Add</button>
        <button class="ghost" onclick="demoFill()">Demo</button>
      </div>
      <div id="chips" class="chips"></div>
      <div class="sep"></div>
      <div class="row">
        <label class="toggle"><input id="bigText" type="checkbox" style="accent-color:var(--accent2)"> Big text</label>
        <label class="toggle"><input id="hideStory" type="checkbox" style="accent-color:var(--accent2)"> Question only</label>
      </div>
    </div>

    <div>
      <div class="title">Deck & Mode</div>
      <div class="row" style="margin-top:8px;">
        <select id="deck">
          <option value="chill">Chill</option>
          <option value="spicy">Spicy</option>
          <option value="saucy" disabled>18+ Saucy (enable below)</option>
        </select>
        <label class="toggle"><input id="adultsOnly" type="checkbox" style="accent-color:var(--accent)"> All players are 18+</label>
      </div>
      <div class="note">The 18+ deck unlocks only if you confirm everyone is an adult. Content stays cheeky, not graphic.</div>
      <div class="sep"></div>
      <div class="row">
        <button class="warn" onclick="startGame()">Start Game</button>
      </div>
    </div>
  </section>

  <!-- ROUND -->
  <section id="round" class="panel hidden">
    <div class="row" style="justify-content:space-between; align-items:center;">
      <div class="title">Round <span id="roundNum">1</span></div>
      <div class="tiny" id="modeHint"></div>
    </div>

    <div class="story" id="storyBox"></div>
    <div class="question" id="questionText"></div>

    <div class="players" id="playerButtons"></div>

    <div class="toolbar">
      <button onclick="undoVote()">Undo vote</button>
      <button onclick="clearVotes()">Clear</button>
      <button class="primary" onclick="reveal()">Reveal winner</button>
    </div>

    <div id="winnerBlock" class="winner hidden" aria-live="polite"></div>

    <div class="toolbar">
      <button onclick="nextRound()">Next round</button>
      <button onclick="endGame()">End game</button>
    </div>

    <div class="scoreboard">
      <div class="title" style="font-size:18px">Scoreboard</div>
      <div id="scores" class="scores"></div>
    </div>
  </section>
</div>

<!-- confetti -->
<div class="confetti" id="confetti"></div>

<script>
/* === State === */
const state = {
  players: [],
  scores: new Map(),
  round: 1,
  votes: [],
  voteCount: new Map(),
  deck:'chill',
  big:false,
  hideStory:false,
  rngSeed: Date.now()%2147483647
};
function rand(){ state.rngSeed = (state.rngSeed * 48271) % 2147483647; return (state.rngSeed-1)/2147483646; }
function choice(a){ return a[Math.floor(rand()*a.length)] }

/* === Elements === */
const setup = document.getElementById('setup');
const roundEl = document.getElementById('round');
const chips = document.getElementById('chips');
const nameInput = document.getElementById('nameInput');
const adultsOnly = document.getElementById('adultsOnly');
const deckSel = document.getElementById('deck');
const storyBox = document.getElementById('storyBox');
const questionText = document.getElementById('questionText');
const playerButtons = document.getElementById('playerButtons');
const roundNum = document.getElementById('roundNum');
const winnerBlock = document.getElementById('winnerBlock');
const scoresEl = document.getElementById('scores');
const bigText = document.getElementById('bigText');
const hideStory = document.getElementById('hideStory');
const modeHint = document.getElementById('modeHint');

/* === Setup === */
function renderChips(){
  chips.innerHTML=''; state.players.forEach((n,i)=>{
    const d=document.createElement('div'); d.className='chip';
    d.innerHTML = `<b>${escapeHtml(n)}</b><button title="Remove" onclick="removePlayer(${i})">✕</button>`;
    chips.appendChild(d);
  });
}
function addPlayer(){
  const v=nameInput.value.trim(); if(!v) return;
  if(state.players.includes(v)) { nameInput.value=''; return; }
  state.players.push(v); state.scores.set(v, state.scores.get(v)||0);
  renderChips(); nameInput.value='';
}
function removePlayer(i){
  const n=state.players[i]; state.players.splice(i,1); state.scores.delete(n); renderChips();
}
function demoFill(){
  ['Alex','Maya','Jo','Pri','Sam','Nico'].forEach(n=>{ if(!state.players.includes(n)){ state.players.push(n); state.scores.set(n,0); }});
  renderChips();
}
adultsOnly.addEventListener('change', ()=>{
  deckSel.querySelector('option[value="saucy"]').disabled = !adultsOnly.checked;
});

/* === Deck content === */
const places = ["a rooftop bar","a neon-lit club","a midnight beach","a karaoke room with sticky floors","a fancy hotel lobby","a crowded patio","a dimly lit speakeasy","an afterparty kitchen","a bonfire by the lake","a private hot tub"];
const props  = ["a feather boa","sunglasses at night","a glittery hat","a half-melted popsicle","a heart-shaped balloon","a rogue confetti cannon","a suspiciously tiny towel","a lipstick-stained napkin","a squeaky rubber duck","a tray of mystery shots"];
const beats  = [
  "Golden hour fades into questionable decisions.",
  "It’s way past midnight and confidence is at 120%.",
  "Everyone’s phones are at 2%, but chaos is at 98%.",
  "A DJ restarts the same song for the third time.",
  "Security pretends not to notice. Heroes.",
  "Someone whispers, “no regrets,” which is legally binding."
];

const chillQs = [
  "start a slow clap that actually works",
  "lead a singalong to the wrong lyrics",
  "tell a story with wildly wrong facts but full confidence",
  "organize a photo with 20 strangers",
  "become best friends with the bartender in 3 minutes",
  "start a dance circle and immediately forget their move",
  "talk the group into a spontaneous road trip",
  "mistake a stranger for an old friend and keep going",
  "volunteer to be DJ and forget to unmute",
  "give an inspirational speech about snacks"
];

const spicyQs = [
  "send a flirty text to the wrong chat and double down",
  "turn truth-or-dare into performance art",
  "kiss someone on the cheek European-style and make it a trend",
  "convince a stranger to rate their wink out of 10",
  "win a dance-off with one scandalous move",
  "pretend to be famous to skip a line",
  "write their number on a napkin with a dramatic wink",
  "start a rumor about themselves and fact-check it later",
  "propose a make-believe couples game with strangers",
  "create a fake secret handshake that becomes real"
];

const saucyQs18 = [
  // cheeky but non-graphic, consent-y, adults only
  "skinny-dip and call it a wellness ritual",
  "suggest a game of “two truths, one spicy lie”",
  "flirt their way into free dessert for the whole table",
  "accidentally send a steamy voice note — then own it",
  "start a dance where everyone has to copy their hips",
  "win a lip-sync battle to an uncomfortably romantic song",
  "ask the DJ for a ‘bedroom playlist’ like it’s normal",
  "start a dare chain that escalates suspiciously fast",
  "offer a ‘practice kiss’ tutorial (with consent forms, obviously)",
  "suggest swapping an item of clothing ‘for the bit’"
];

function buildStoryAndQuestion(){
  const place = choice(places), prop = choice(props), beat = choice(beats);
  const deck = state.deck==='saucy' ? saucyQs18 : state.deck==='spicy' ? spicyQs : chillQs;
  const q = choice(deck);
  const story = `<b>Scene:</b> You’re at ${place}. ${beat} Someone appears with ${pref(prop)}.`;
  return {story, question:q};
}
function buildEnding(winner){
  const tags = [
    `${winner} bows like this was planned all week.`,
    `${winner} calls it “character development.”`,
    `${winner} claims it was a social experiment and somehow you believe it.`,
    `${winner} gets a random “you up?” text two minutes later.`,
    `${winner} says “no cameras” then poses for three.`,
    `${winner} receives a standing ovation from exactly one person. Iconic.`
  ];
  return choice(tags);
}

/* === Game flow === */
function startGame(){
  if(state.players.length<2){ alert('Add at least 2 players to start.'); return; }
  const want = deckSel.value;
  if(want==='saucy' && !adultsOnly.checked){ alert('18+ deck requires confirming all players are adults.'); return; }
  state.deck = want;
  state.big = bigText.checked;
  state.hideStory = hideStory.checked;

  document.body.classList.toggle('xl', state.big);

  setup.classList.add('hidden');
  roundEl.classList.remove('hidden');
  state.round = 1;
  nextRound(true);
  modeHint.textContent = `Deck: ${state.deck === 'chill' ? 'Chill' : state.deck === 'spicy' ? 'Spicy' : '18+ Saucy'}`;
}

function buildPlayerButtons(){
  playerButtons.innerHTML='';
  state.players.forEach(p=>{
    const b=document.createElement('button'); b.className='pbtn'; b.onclick=()=>vote(p,b);
    b.innerHTML=`<span>${escapeHtml(p)}</span><small>0</small>`;
    playerButtons.appendChild(b);
  });
}
function resetVotes(){
  state.votes=[]; state.voteCount=new Map(state.players.map(p=>[p,0]));
  [...playerButtons.children].forEach(b=>b.querySelector('small').textContent='0');
  winnerBlock.classList.add('hidden'); winnerBlock.innerHTML='';
}
function vote(name, btn){
  const c=(state.voteCount.get(name)||0)+1; state.voteCount.set(name,c);
  state.votes.push(name); btn.querySelector('small').textContent=String(c);
}
function undoVote(){
  const last=state.votes.pop(); if(!last) return;
  const c=(state.voteCount.get(last)||0)-1; state.voteCount.set(last,Math.max(0,c));
  [...playerButtons.children].forEach(b=>{
    if(b.querySelector('span').textContent===last) b.querySelector('small').textContent=String(Math.max(0,c));
  });
}
function clearVotes(){ resetVotes(); }

function reveal(){
  let max=-1,tops=[];
  state.voteCount.forEach((v,k)=>{ if(v>max){max=v;tops=[k]} else if(v===max){tops.push(k)} });
  if(max<=0){ alert('No votes yet. Tap a name to vote.'); return; }
  const winner = choice(tops);
  state.scores.set(winner,(state.scores.get(winner)||0)+1);
  renderScores();
  winnerBlock.innerHTML = `🏆 <b>${escapeHtml(winner)}</b> takes it with ${max} vote${max>1?'s':''}.<br>${buildEnding(winner)}`;
  winnerBlock.classList.remove('hidden');
  confetti();
}
function nextRound(first=false){
  if(!first) state.round++;
  roundNum.textContent = state.round;
  const {story,question} = buildStoryAndQuestion();
  storyBox.innerHTML = state.hideStory ? '<span class="tiny">Story hidden</span>' : story;
  questionText.textContent = 'Who is most likely to ' + question + '?';
  buildPlayerButtons(); resetVotes();
  window.scrollTo({top:0,behavior:'smooth'});
}
function endGame(){
  const top = Math.max(...[...state.scores.values(),0]);
  const champs = [...state.scores.entries()].filter(([_,v])=>v===top).map(([k])=>k);
  alert(top>0?`Winner${champs.length>1?'s':''}: ${champs.join(', ')} with ${top} point${top>1?'s':''}!`:'No points scored!');
}

/* === Scoreboard === */
function renderScores(){
  const arr=[...state.scores.entries()].sort((a,b)=>b[1]-a[1]||a[0].localeCompare(b[0]));
  scoresEl.innerHTML=''; arr.forEach(([n,s])=>{
    const d=document.createElement('div'); d.className='score';
    d.innerHTML=`<span>${escapeHtml(n)}</span><b>${s}</b>`; scoresEl.appendChild(d);
  });
}

/* === Confetti === */
function confetti(){
  const host=document.getElementById('confetti');
  for(let i=0;i<90;i++){
    const p=document.createElement('i');
    p.style.left = (Math.random()*100)+'%';
    p.style.top  = '-8%';
    p.style.background = `hsl(${Math.random()*360},90%,60%)`;
    const dur = 3+Math.random()*2;
    const rot = (Math.random()*720-360)+'deg';
    p.animate([
      {transform:`translate(-50%,0) rotate(0deg)`, opacity:1},
      {transform:`translate(${(Math.random()*120-60)}px, 110vh) rotate(${rot})`, opacity:1}
    ], {duration: dur*1000, easing:'cubic-bezier(.2,.6,.2,1)'}).onfinish=()=>p.remove();
    host.appendChild(p);
  }
}

/* === Helpers === */
function escapeHtml(s){ return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])) }
function pref(word){ return (/^[aeiou]/i.test(word)?'an ':'a ')+word; }

/* Init */
renderScores();
</script>
</body>
</html>