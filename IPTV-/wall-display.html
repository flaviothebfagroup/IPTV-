<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BFA IPTV — Monitor Wall</title>

<style>
  :root{
    --brand:#ff6a00;
    --brand2:#ff9330;
    --fg:#0f172a;
    --muted:#64748b;
  }

  *{box-sizing:border-box;margin:0;padding:0;}
  html,body{
    width:100%;
    height:100%;
    overflow:hidden;
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    color:var(--fg);
    background:#050816;
  }

  /* Background tuned for 1920×1080 but responsive */
  body{
    background:
      radial-gradient(circle at -10% 0%, #fff1d9 0%, #ffcb83 18%, transparent 35%),
      radial-gradient(circle at 110% 0%, #ffc0ca 0%, #ff8994 22%, transparent 45%),
      radial-gradient(circle at 8% 110%, #ffefcf 0%, #ffd098 20%, transparent 45%),
      radial-gradient(circle at 85% 120%, #ffb964 0%, #ff6a00 35%, #050816 70%);
    background-color:#050816;
  }

  .frame{
    position:relative;
    width:100%;
    height:100%;
    padding:16px;          /* slightly tighter */
  }

  .shell{
    position:relative;
    width:100%;
    height:100%;
    border-radius:28px;
    background:linear-gradient(145deg,rgba(255,255,255,.90),rgba(246,248,255,.88));
    box-shadow:
      0 28px 80px rgba(15,23,42,.75),
      0 0 0 1px rgba(255,255,255,.80);
    padding:12px 18px 12px; /* slightly tighter */
    display:flex;
    flex-direction:column;
  }

  /* HEADER */

  .shell-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom:8px;    /* was 12 */
  }

  .brand-left{
    display:flex;
    align-items:center;
    gap:14px;
    min-width:0;
  }

  .logo-wrap{
    width:56px;
    height:56px;
    border-radius:24px;
    background:linear-gradient(145deg,#ffdfb9,#ff6a00);
    box-shadow:
      0 18px 40px rgba(15,23,42,.55),
      inset 0 1px 0 rgba(255,255,255,.8);
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .logo{
    width:36px;
    height:36px;
    border-radius:16px;
    background:#ffffff;
    box-shadow:0 10px 26px rgba(0,0,0,.55);
  }

  .brand-text{
    min-width:0;
  }
  .brand-title{
    font-size:20px;
    font-weight:800;
    color:#020617;
    letter-spacing:.02em;
  }
  .brand-sub{
    font-size:12px;
    color:var(--muted);
    margin-top:3px;
  }

  .status-pill{
    padding:6px 13px;
    border-radius:999px;
    background:linear-gradient(135deg,#020617,#111827);
    color:#e5e7eb;
    font-size:11px;
    display:inline-flex;
    align-items:center;
    gap:7px;
    box-shadow:0 18px 40px rgba(15,23,42,.8);
  }
  .status-dot{
    width:9px;
    height:9px;
    border-radius:999px;
    background:#22c55e;
  }

  .layout{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:8px;          /* was 12 */
    min-height:0;
  }

  /* HERO (top) */

  .hero-wrap{
    flex:1;
    min-height:0;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .hero-card{
    width:100%;
    max-width:1100px;   /* smaller so 16:9 fits above dock */
    border-radius:22px;
    background:#020617;
    box-shadow:
      0 20px 60px rgba(15,23,42,.70),
      0 0 0 1px rgba(15,23,42,.9);
    overflow:hidden;
    position:relative;
  }

  .hero-16x9{
    position:relative;
    width:100%;
    height:0;
    padding-top:56.25%; /* 16:9 */
  }

  .hero-16x9 video{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
    background:#000;
    display:block;
  }

  .hero-bar{
    position:absolute;
    left:0;
    right:0;
    bottom:0;
    padding:9px 13px 10px;
    display:flex;
    justify-content:space-between;
    align-items:flex-end;
    font-size:11px;
    color:#e5e7eb;
    background:linear-gradient(180deg,rgba(15,23,42,0) 0%,rgba(15,23,42,.60) 42%,rgba(15,23,42,.96) 100%);
  }

  .hero-left{
    max-width:70%;
  }
  .hero-kicker{
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:#cbd5f5;
    margin-bottom:3px;
  }
  .hero-name{
    font-size:15px;
    font-weight:800;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .hero-meta{
    margin-top:3px;
    font-size:11px;
    color:#e5e7eb;
    opacity:.88;
  }

  .hero-tag{
    padding:6px 11px;
    border-radius:999px;
    background:linear-gradient(135deg,#f97316,#fb923c);
    color:#111827;
    font-size:11px;
    font-weight:600;
    box-shadow:
      0 18px 40px rgba(15,23,42,.9),
      0 0 0 1px rgba(248,250,252,.7);
  }

  /* DOCK */

  .dock-card{
    border-radius:22px;
    background:linear-gradient(135deg,rgba(255,255,255,.96),rgba(248,245,240,.98));
    box-shadow:
      0 16px 40px rgba(148,163,184,.6),
      0 0 0 1px rgba(255,255,255,.9);
    padding:8px 10px 9px;  /* slightly tighter */
  }

  .dock-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-size:12px;
    color:var(--muted);
    margin-bottom:6px;
  }

  .dock-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    grid-auto-rows:1fr;
    gap:7px;
  }

  .tile{
    position:relative;
    border-radius:16px;
    background:#020617;
    box-shadow:0 12px 30px rgba(15,23,42,.55);
    border:1px solid rgba(15,23,42,.85);
    overflow:hidden;
    cursor:pointer;
    -webkit-tap-highlight-color:transparent;
    transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  }

  .tile-inner{
    position:relative;
    width:100%;
    height:0;
    padding-top:56.25%; /* 16:9 thumbnails */
  }

  .tile video{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
    background:#000;
    display:block;
  }

  .tile-overlay{
    position:absolute;
    left:0;
    right:0;
    bottom:0;
    padding:5px 8px;
    font-size:10px;
    color:#e5e7eb;
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:linear-gradient(180deg,rgba(0,0,0,0) 0%,rgba(0,0,0,.90) 60%,rgba(0,0,0,.97) 100%);
  }

  .tile-name{
    font-weight:600;
    max-width:70%;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }

  .tile-status{
    font-size:10px;
    opacity:.9;
  }
  .tile-status.error{color:#fecaca;}
  .tile-status.idle{color:#9ca3af;}
  .tile-status.ok{color:#bbf7d0;}

  /* ACTIVE DOCK TILE */

  .tile.active{
    transform:translateY(-3px) scale(1.04);
    border-color:rgba(255,149,0,.95);
    box-shadow:
      0 18px 44px rgba(15,23,42,.85),
      0 0 0 1px rgba(251,146,60,.9);
  }

  .hint{
    margin-top:2px;
    font-size:11px;
    color:var(--muted);
    text-align:right;
  }

  .banner{
    position:absolute;
    left:50%;
    bottom:16px;
    transform:translateX(-50%);
    padding:7px 14px;
    border-radius:999px;
    background:rgba(239,68,68,.96);
    color:#fff;
    font-size:11px;
    box-shadow:0 18px 40px rgba(0,0,0,.85);
    display:none;
  }

  @media (max-width:1100px){
    .frame{padding:10px;}
    .shell{border-radius:18px;padding:10px 10px 12px;}
    .shell-header{flex-direction:column;align-items:flex-start;gap:8px;}
  }
</style>
</head>
<body>
<div class="frame">
  <div class="shell">
    <header class="shell-header">
      <div class="brand-left">
        <div class="logo-wrap">
          <img class="logo" src="/IPTV-/icons/icon-192.png" alt="BFA logo"
     onerror="this.onerror=null;this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2236%22 height=%2236%22 viewBox=%220 0 38 38%22%3E%3Crect width=%2238%22 height=%2238%22 rx=%2216%22 fill=%22%23ffffff%22/%3E%3Ctext x=%2250%25%22 y=%2255%25%22 text-anchor=%22middle%22 font-size=%2213%22 font-family=%22system-ui%22 font-weight=%22800%22 fill=%22%23ff6a00%22%3EBFA%3C/text%3E%3C/svg%3E';">

        </div>
        <div class="brand-text">
          <div class="brand-title">BFA IPTV — Monitor Wall</div>
          <div class="brand-sub"></div>
        </div>
      </div>
      <div class="status-pill">
        <span class="status-dot" id="statusDot"></span>
        <span id="statusText">Starting…</span>
      </div>
    </header>

    <section class="layout">
      <!-- HERO -->
      <div class="hero-wrap">
        <div class="hero-card">
          <div class="hero-16x9">
            <video id="heroVideo" autoplay muted playsinline></video>
            <div class="hero-bar">
              <div class="hero-left">
                <div class="hero-kicker">Now showing</div>
                <div id="heroName" class="hero-name">—</div>
                <div id="heroMeta" class="hero-meta">Loading…</div>
              </div>
              <div id="heroTag" class="hero-tag">LIVE</div>
            </div>
          </div>
        </div>
      </div>

      <!-- DOCK -->
      <div class="dock-card">
        <div class="dock-header">
          <span>Channel dock</span>
          <span id="dockSummary"></span>
        </div>
        <div id="dockGrid" class="dock-grid"></div>
      </div>

      <div class="hint">
        If BrightSign struggles, reduce channels or set PLAY_DOCK_VIDEOS = false so only the hero decodes.
      </div>
    </section>
  </div>

  <div id="banner" class="banner"></div>
</div>

<script>
  /* ===== CONFIG ===== */
  var CONFIG = {
    ROTATE_SECONDS: 20,
    PLAY_DOCK_VIDEOS: true,   // keep true if you want dock motion
    channels: [
      {
        name: "News",
        url: "https://citynewsregional.akamaized.net/hls/live/1024052/Regional_Live_7/Video-2Mbps.m3u8"
        // previewUrl: "https://...lower-res.m3u8"  // OPTIONAL: lower-res dock feed
      },
      {
      name: "TSN 5",
        url: "https://fl31.moveonjoy.com/TSN_5/index.m3u8"
      },
      {
        name: "Tennis Channel S",
        url: "https://amg01444-tennischannelth-tennischannelnl-samsungnl-x3dq1.amagi.tv/playlist/amg01444-tennischannelth-tennischannelnl-samsungnl/playlist.m3u8"
      },
      {
        name: "Cooking",
        url: "https://gusto-xumo.amagi.tv/playlist.m3u8"
      },
      {
        name: "Love Nature",
        url: "https://aegis-cloudfront-1.tubi.video/6d6d0f24-8445-4b4c-bdf6-44f9e38beaa4/playlist.m3u8"
      },
      {
        name: "Kids",
        url: "https://c0c65b821b3542c3a4dca92702f59944.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/RakutenTV-eu_BabySharkTV/playlist.m3u8"
      }
      // add more channels if you like; previewUrl is optional
    ]
  };

  /* ===== RUNTIME (BrightSign-safe JS) ===== */

  function isUrl(u){
    return /^https?:\/\/\S+$/i.test((u || "").replace(/\s+/g,""));
  }

  var heroVideo   = document.getElementById("heroVideo");
  var heroNameEl  = document.getElementById("heroName");
  var heroMetaEl  = document.getElementById("heroMeta");
  var heroTagEl   = document.getElementById("heroTag");
  var statusDot   = document.getElementById("statusDot");
  var statusText  = document.getElementById("statusText");
  var bannerEl    = document.getElementById("banner");
  var dockGrid    = document.getElementById("dockGrid");
  var dockSummary = document.getElementById("dockSummary");

  var CHANNELS    = [];
  var heroIndex   = 0;
  var rotateTimer = null;

  // one entry per dock tile: { video, statusEl, index, active }
  var dockEntries = [];

  function showBanner(msg){
    bannerEl.textContent = msg;
    bannerEl.style.display = "block";
  }
  function hideBanner(){
    bannerEl.style.display = "none";
  }

  function setStatus(ok, msg){
    statusDot.style.backgroundColor = ok ? "#22c55e" : "#ef4444";
    statusText.textContent = msg;
  }

  // Attach a URL to a <video> with native HLS (BrightSign-safe)
  function attachNative(video, url, stateCb){
    video.src = "";
    video.load();
    video.muted = true;
    video.autoplay = true;
    video.playsInline = true;

    if(!isUrl(url)){
      if(stateCb){ stateCb("error","No URL"); }
      return;
    }

    url = url.replace(/\s+/g,"");
    video.src = url;

    var started = false;

    video.onplaying = function(){
      if(!started){
        started = true;
        if(stateCb){ stateCb("ok","LIVE"); }
      }
    };

    video.onerror = function(){
      if(stateCb){ stateCb("error","Error"); }
    };

    var p = null;
    try{ p = video.play(); }catch(e){}

    if(p && typeof p.then === "function"){
      p.then(function(){
        if(!started && stateCb){ stateCb("ok","LIVE"); }
      }).catch(function(){
        if(stateCb){ stateCb("idle","Tap"); }
      });
    }
  }

  /* ---- Dock helpers ---- */

  function getDockUrl(idx){
    var ch = CHANNELS[idx];
    if(ch.previewUrl && isUrl(ch.previewUrl)){ return ch.previewUrl; }
    return ch.url;
  }

  function startDockStream(idx){
    if(!CONFIG.PLAY_DOCK_VIDEOS){ return; }
    var entry = dockEntries[idx];
    if(!entry || entry.active){ return; }

    var ch = CHANNELS[idx];
    var url = getDockUrl(idx);

    attachNative(entry.video, url, function(state,label){
      var statusEl = entry.statusEl;
      if(!statusEl){ return; }

      if(state === "ok"){
        statusEl.textContent = "LIVE";
        statusEl.className   = "tile-status ok";
      }else if(state === "idle"){
        statusEl.textContent = "Tap";
        statusEl.className   = "tile-status idle";
      }else if(state === "error"){
        statusEl.textContent = "Error";
        statusEl.className   = "tile-status error";
      }
    });

    entry.active = true;
  }

  function stopDockStream(idx, reason){
    var entry = dockEntries[idx];
    if(!entry || !entry.active){ return; }

    try{
      entry.video.pause();
      entry.video.removeAttribute("src");
      entry.video.load();
    }catch(e){}

    entry.active = false;

    if(entry.statusEl){
      entry.statusEl.textContent = reason || "On air ↑";
      entry.statusEl.className   = "tile-status idle";
    }
  }

  /* ---- Hero ---- */

  function loadHero(idx){
    if(!CHANNELS.length){ return; }
    if(idx < 0){ idx = 0; }
    if(idx >= CHANNELS.length){ idx = 0; }
    heroIndex = idx;

    var ch = CHANNELS[idx];
    heroNameEl.textContent = ch.name || ("Channel " + (idx+1));
    heroMetaEl.textContent = "Loading…";
    heroTagEl.textContent  = "LIVE · " + (idx+1) + "/" + CHANNELS.length;

    // update dock tile active state
    var tiles = dockGrid.getElementsByClassName("tile");
    var i;
    for(i=0;i<tiles.length;i++){
      if(parseInt(tiles[i].getAttribute("data-index"),10) === idx){
        if(tiles[i].className.indexOf("active") === -1){
          tiles[i].className += " active";
        }
      }else{
        tiles[i].className = tiles[i].className.replace(/\s*active/g,"");
      }
    }

    hideBanner();

    // full-quality stream for hero
    attachNative(heroVideo, ch.url, function(state,label){
      if(state === "ok"){
        heroMetaEl.textContent = "LIVE · native HLS";
        setStatus(true,"Streaming " + (idx+1) + "/" + CHANNELS.length);
      }else if(state === "idle"){
        heroMetaEl.textContent = "Tap to start (desktop).";
        showBanner("On BrightSign the hero should auto-play. If not, reduce channels.");
      }else if(state === "error"){
        heroMetaEl.textContent = "Stream error.";
        setStatus(false,"Stream error on channel " + (idx+1));
        showBanner("Stream error — check URL or codec.");
      }
    });

    // hero should NOT play in dock: stop its preview stream
    stopDockStream(idx, "On air ↑");

    // make sure other dock tiles have their preview playing
    if(CONFIG.PLAY_DOCK_VIDEOS){
      for(i=0;i<CHANNELS.length;i++){
        if(i === idx){ continue; }
        startDockStream(i);
      }
    }

    restartRotation();
  }

  function restartRotation(){
    if(rotateTimer){
      clearInterval(rotateTimer);
    }
    if(CHANNELS.length <= 1){
      return;
    }
    var delayMs = (CONFIG.ROTATE_SECONDS || 20) * 1000;
    rotateTimer = setInterval(function(){
      var next = heroIndex + 1;
      if(next >= CHANNELS.length){ next = 0; }
      loadHero(next);
    }, delayMs);
  }

  /* ---- Dock build ---- */

  function buildDock(){
    dockGrid.innerHTML = "";
    dockEntries = [];

    var i;
    for(i=0;i<CHANNELS.length;i++){
      (function(idx){
        var ch = CHANNELS[idx];
        var tile  = document.createElement("button");
        tile.type = "button";
        tile.className = "tile";
        tile.setAttribute("data-index", String(idx));

        var inner = document.createElement("div");
        inner.className = "tile-inner";

        var v = document.createElement("video");
        v.autoplay = true;
        v.muted    = true;
        v.playsInline = true;

        var overlay = document.createElement("div");
        overlay.className = "tile-overlay";

        var nameEl = document.createElement("div");
        nameEl.className = "tile-name";
        nameEl.textContent = ch.name || ("Ch " + (idx+1));

        var statusEl = document.createElement("div");
        statusEl.className = "tile-status idle";
        statusEl.textContent = CONFIG.PLAY_DOCK_VIDEOS ? "Loading…" : "Select";

        overlay.appendChild(nameEl);
        overlay.appendChild(statusEl);
        inner.appendChild(v);
        inner.appendChild(overlay);
        tile.appendChild(inner);
        dockGrid.appendChild(tile);

        dockEntries[idx] = {
          video: v,
          statusEl: statusEl,
          index: idx,
          active: false
        };

        if(CONFIG.PLAY_DOCK_VIDEOS){
          startDockStream(idx);
        }

        tile.onclick = function(){
          loadHero(idx);
        };
      })(i);
    }

    dockSummary.textContent = CHANNELS.length + " channel" + (CHANNELS.length>1 ? "s" : "") + " configured";
  }

  /* ---- Init ---- */

  function init(){
    var raw = CONFIG.channels || [];
    var cleaned = [];
    var i;
    for(i=0;i<raw.length;i++){
      if(raw[i] && isUrl(raw[i].url)){
        cleaned.push({
          name: raw[i].name || ("Channel " + (cleaned.length+1)),
          url:  raw[i].url,
          previewUrl: raw[i].previewUrl || ""
        });
      }
    }
    CHANNELS = cleaned;

    if(!CHANNELS.length){
      setStatus(false,"No valid channels in CONFIG");
      showBanner("Add at least one valid m3u8 URL in CONFIG.channels.");
      return;
    }

    setStatus(true,"Initialized " + CHANNELS.length + " channel(s)");
    buildDock();
    loadHero(0);
  }

  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", init);
  }else{
    init();
  }
</script>

</body>
</html>
