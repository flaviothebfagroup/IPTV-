<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>BFA IPTV â€” Admin</title>

  <!-- PWA bits -->
  <link rel="manifest" href="/IPTV-/manifest.webmanifest" />
  <meta name="theme-color" content="#000000" />
  <link rel="icon" type="image/png" sizes="192x192" href="/IPTV-/icons/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/IPTV-/icons/icon-512.png" />
  <link rel="apple-touch-icon" href="/IPTV-/icons/icon-192.png" />

  <style>
    :root{
      --bg:#0b0b0c;--fg:#fff;--muted:#9a9aa0;--panel:#121214;--border:rgba(255,255,255,.14);
      --accent:#ff9500;--tile:#17171a;--tileActive:#1d1d21;--shadow:0 18px 48px rgba(0,0,0,.45);
      --radius:18px;--radius-lg:22px;--ok:#22c55e;--warn:#f59e0b;--err:#ef4444
    }
    body.light{
      --bg:#f5f5f7;--fg:#111;--muted:#6e6e73;--panel:#fff;--border:rgba(0,0,0,.12);
      --tile:#f2f2f7;--tileActive:#eaeaef;--shadow:0 14px 36px rgba(0,0,0,.10)
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{background:var(--bg);color:var(--fg);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display',system-ui,sans-serif;margin:0}
    a{color:inherit;text-decoration:none}

    /* Shell */
    .wrap{max-width:1200px;margin:0 auto;padding:18px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius-lg);padding:16px;box-shadow:var(--shadow)}
    .page{display:none}
    .page.active{display:block}
    .crumb{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:999px;padding:0 12px;background:var(--tile);margin-bottom:12px;cursor:pointer;height:34px}
    .crumb b{font-size:12px}

    /* Bento home */
    #homeGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media (max-width:980px){#homeGrid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){#homeGrid{grid-template-columns:1fr}}
    .tile{display:flex;flex-direction:column;gap:8px;min-height:120px;padding:16px;border:1px solid var(--border);border-radius:20px;background:var(--tile);cursor:pointer;transition:transform .08s,border-color .2s,box-shadow .2s}
    .tile:hover{transform:translateY(-1px);border-color:var(--accent);box-shadow:0 8px 22px rgba(255,149,0,.15)}
    .tile h3{margin:0;font-size:16px}
    .tile p{margin:0;color:var(--muted);font-size:12px}

    /* Inputs */
    .row{display:grid;grid-template-columns:1fr auto;gap:10px;margin:10px 0}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:10px 0}
    .row3{display:grid;grid-template-columns:1fr 1fr auto;gap:10px;margin:10px 0}
    .row4{display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:10px;margin:10px 0}
    @media (max-width:720px){.row,.row2,.row3,.row4{grid-template-columns:1fr;gap:8px}}
    .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    .input,.select{width:100%;padding:12px;background:transparent;border:1px solid var(--border);border-radius:12px;color:var(--fg);font-size:14px;outline:none}
    .input::placeholder{color:var(--muted)}
    .btn{height:34px;padding:0 14px;border-radius:9999px;border:1px solid var(--border);background:var(--tile);color:var(--fg);font-weight:800;cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
    .btn.primary{border-color:var(--accent);color:var(--accent);background:transparent}
    .btn.solid{padding:12px;border-radius:12px;background:var(--accent);border:0;color:#000;font-weight:900;cursor:pointer}
    .btn.danger{border-color:#ff6b6b;color:#ff6b6b}
    .muted{color:var(--muted);font-size:12px}
    .small{font-size:12px}

    /* Lists / items */
    .list{margin:8px 0 0;padding:0;list-style:none}
    .empty{padding:12px;border:1px dashed var(--border);border-radius:12px;color:var(--muted);text-align:center}
    .item{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;padding:12px;margin:8px 0;background:var(--tile);border:1px solid var(--border);border-radius:12px;flex-wrap:wrap}
    .split{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    .col{display:flex;flex-direction:column;gap:6px;min-width:200px}
    .tag{padding:2px 8px;border:1px solid var(--border);border-radius:999px;background:transparent;font-size:12px;color:var(--muted)}
    .online{display:inline-flex;align-items:center;gap:6px;font-size:12px}
    .dot{width:8px;height:8px;border-radius:999px;background:#999}
    .dot.ok{background:var(--ok)}
    .dot.warn{background:var(--warn)}
    .dot.err{background:var(--err)}
    .vol{display:flex;align-items:center;gap:8px}
    .vol input[type="range"]{width:140px;accent-color:var(--accent)}
    @media (max-width:560px){ .vol input[type="range"]{width:100%} }

    /* Users grid */
    .user-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:10px}
    .user-card{background:var(--tile);border:1px solid var(--border);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:10px}
    .user-header{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .user-name{font-weight:800}
    .badge{border:1px solid var(--border);border-radius:999px;padding:2px 8px;font-size:11px;color:var(--muted)}
    .user-actions{display:flex;gap:8px;flex-wrap:wrap}

    /* Links grid */
    .apps-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:8px}
    @media (max-width:1060px){ .apps-grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:560px){ .apps-grid{grid-template-columns:1fr} }
    .app-tile{display:flex;gap:12px;align-items:center;padding:12px;border:1px solid var(--border);border-radius:16px;background:var(--tile);text-decoration:none;color:inherit;transition:transform .1s, box-shadow .2s, border-color .2s}
    .app-tile:hover{transform:translateY(-1px);border-color:var(--accent);box-shadow:0 8px 22px rgba(255,149,0,.15)}
    .app-emoji{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;background:var(--tileActive);border:1px solid var(--border);font-size:20px}
    .app-logo{width:40px;height:40px;border-radius:12px;border:1px solid var(--border);background:var(--tileActive) center/cover no-repeat}
    .app-info{display:flex;flex-direction:column;gap:2px}
    .app-title{font-weight:800}
    .app-desc{font-size:12px;color:var(--muted)}
    .apps-note{margin-top:6px;font-size:12px;color:var(--muted)}

    /* Analytics */
    .stats{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:8px 0}
    @media (max-width:980px){.stats{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:560px){.stats{grid-template-columns:1fr}}
    .stat{background:var(--tile);border:1px solid var(--border);border-radius:12px;padding:14px}
    .stat b{font-size:22px}
    .bar{height:10px;background:var(--tileActive);border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#ffb866)}

    /* Toast */
    .toast{position:fixed;bottom:26px;left:50%;transform:translateX(-50%);background:var(--accent);color:#000;padding:10px 16px;border-radius:999px;font-weight:900;opacity:0;transition:opacity .25s;pointer-events:none;z-index:999}
    .toast.show{opacity:1}
    .toast.err{background:#ff453a;color:#fff}

    /* === Consistent topbar + hamburger (shared) === */
    .topbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:12px;padding:12px 16px;background:linear-gradient(0deg,transparent,rgba(0,0,0,.06));backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
    .lhs{display:flex;align-items:center;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;letter-spacing:.3px}
    .logo{width:36px;height:36px;border-radius:10px;border:1px solid var(--border);background:var(--tile) center/cover no-repeat}
    #hamburger{margin-left:auto;height:36px;padding:0 12px;border-radius:10px;border:1px solid var(--border);background:var(--tile);color:var(--fg);font-weight:800;cursor:pointer;display:none}
    #navMenu{margin-left:auto}
    .nav-actions{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    @media (max-width:900px){
      #hamburger{display:inline-flex;align-items:center;justify-content:center}
      #navMenu{display:none;position:absolute;top:58px;left:0;right:0;background:linear-gradient(0deg,rgba(0,0,0,.06),rgba(0,0,0,.06));backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:10px}
      #navMenu.open{display:block}
      .nav-actions{flex-direction:column;align-items:stretch}
      .nav-actions .btn, .nav-actions a.btn{width:100%}
    }
  </style>
</head>
<body>

  <!-- Topbar (standardized) -->
  <div class="topbar" role="banner">
    <div class="lhs">
      <a class="brand" href="home.html" aria-label="BFA IPTV Home">
        <div id="brandLogo" class="logo" title="IPTV" aria-hidden="true"></div>
        <span>BFA IPTV â€” Admin</span>
      </a>
    </div>
    <button id="hamburger" aria-label="Menu" aria-controls="navMenu" aria-expanded="false">â˜°</button>
    <nav id="navMenu" aria-label="Primary">
      <div class="nav-actions">
        <a class="btn" href="home.html">Home</a>
        <a class="btn" href="dealerships.html">Dealerships</a>
        <a class="btn" href="displays.html">Displays</a>
        <a class="btn" href="users.html">Users</a>
        <a class="btn" href="links.html">Links</a>
        <a class="btn" href="analytics.html">Analytics</a>
        <a class="btn" href="schedule.html">Schedule</a>
        <span id="adminEmail" class="muted"></span>
        <button id="themeBtn"  class="btn" type="button">â˜€ï¸Ž/ðŸŒ™</button>
        <button id="reloadBtn" class="btn" type="button">Reload</button>
        <button id="syncBtn" class="btn primary" type="button">Sync â†’ GitHub</button>
        <button id="settingsBtn" class="btn primary" type="button">Settings</button>
        <button id="signOutBtn" class="btn primary" type="button">Sign out</button>
      </div>
    </nav>
  </div>

  <div class="wrap">
    <!-- Login -->
    <div id="loginBox" class="card" style="max-width:520px;margin:40px auto;display:none">
      <h2 style="margin:0 0 12px">Admin Sign In</h2>
      <div class="row2">
        <div>
          <div class="label">Email</div>
          <input id="email" class="input" type="email" placeholder="you@company.com" autocomplete="email" />
        </div>
        <div>
          <div class="label">Password</div>
          <input id="password" class="input" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
        </div>
      </div>
      <div class="row2">
        <button id="loginBtn" class="btn solid">Sign in</button>
        <button id="resetBtn" class="btn">Send reset link</button>
      </div>
      <div class="small muted">Requires <b>role: "admin"</b> in <code>/user/{uid}</code>.</div>
    </div>

    <!-- Not admin -->
    <div id="notAdmin" class="card" style="display:none;max-width:720px;margin:40px auto">
      <h2>Not authorized</h2>
      <div class="muted small">Ask an admin to set your role to <b>admin</b> in the database.</div>
    </div>

    <!-- HOME (bento) -->
    <div id="home" class="page">
      <div id="homeGrid">
        <div class="tile" data-page="dealers"><h3>Dealerships</h3><p>Add / rename (migrate) / delete</p></div>
        <div class="tile" data-page="displays"><h3>Displays</h3><p>Live list â€¢ channel â€¢ volume</p></div>
        <div class="tile" data-page="users"><h3>Users</h3><p>Create â€¢ roles â€¢ duplicates</p></div>
        <div class="tile" data-page="links"><h3>Links</h3><p>Quick access</p></div>
        <div class="tile" data-page="analytics"><h3>Analytics</h3><p>Now â€¢ channels â€¢ dealers</p></div>
        <div class="tile" data-page="schedule"><h3>Schedule</h3><p>Installs â€¢ reminders</p></div>
        <div class="tile" data-page="backups"><h3>Backups</h3><p>Download / restore preview</p></div>
      </div>
    </div>

    <!-- PAGES ... (UNCHANGED content below) -->
    <!-- Dealerships -->
    <!-- Displays -->
    <!-- Users -->
    <!-- Links -->
    <!-- Analytics -->
    <!-- Schedule -->
    <!-- Backups -->
    <!-- (Everything below here is your original code; only header changed) -->

  </div>

  <div id="toast" class="toast"></div>

  <!-- Settings dialog (unchanged) -->
  <dialog id="settingsDlg" style="border:0;padding:0;border-radius:18px;max-width:720px;width:96vw">
    <!-- ... unchanged inner content ... -->
  </dialog>

  <!-- === Your original <script type="module"> (UNCHANGED) === -->
  <script type="module">
    /* (all your existing admin.js logic preserved exactly as you shared) */
    /* ... FULL ORIGINAL SCRIPT CONTENT HERE (unchanged) ... */
  </script>

  <!-- Tiny hamburger toggler (no dependency, safe anywhere at end) -->
  <script>
    (()=>{const b=document.getElementById('hamburger');const m=document.getElementById('navMenu');if(!b||!m)return;b.addEventListener('click',()=>{const o=m.classList.toggle('open');b.setAttribute('aria-expanded',String(o));});window.addEventListener('resize',()=>{if(window.innerWidth>900){m.classList.remove('open');b.setAttribute('aria-expanded','false');}});})();
  </script>
</body>
</html>
