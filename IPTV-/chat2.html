<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>BFA Support — Live Chat</title>

  <style>
    :root{
      --accent:#ff9500;
      --bg-start:#fff4e4;
      --bg-mid:#ffd293;
      --bg-end:#ff9500;

      --fg:#111;
      --muted:#6e6e73;

      --panel:rgba(255,255,255,.58);
      --tile:rgba(255,255,255,.46);
      --border:rgba(15,23,42,.10);
      --borderStrong:rgba(15,23,42,.18);
      --shadow:0 14px 34px rgba(15,23,42,.08), 0 2px 8px rgba(15,23,42,.05);

      --glass-blur:16px;
      --glass-sat:140%;
      --r:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;color:var(--fg);
      font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display',system-ui,sans-serif;
      background:transparent;
    }
    body::before{
      content:"";
      position:fixed; inset:0; z-index:-1; pointer-events:none;
      background:linear-gradient(180deg,var(--bg-start) 0%, var(--bg-mid) 52%, var(--bg-end) 100%);
    }

    .topbar{
      position:sticky; top:0; z-index:100;
      background:var(--panel);
      border-bottom:1px solid var(--border);
      padding:calc(10px + env(safe-area-inset-top,0)) 14px 10px;
      backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
      -webkit-backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
    }
    .toprow{
      max-width:980px;margin:0 auto;
      display:flex;align-items:center;gap:12px;
    }
    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .logo{
      width:34px;height:34px;border-radius:10px;
      border:1px solid var(--border);
      background:#fff;
      display:grid;place-items:center;
      font-weight:1000;
      letter-spacing:.4px;
    }
    .brand h1{
      margin:0;font-size:18px;font-weight:1000;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }

    /* Simple hamburger on RIGHT */
    .hamburger{
      margin-left:auto;
      border:0;background:transparent;color:var(--accent);
      width:44px;height:44px;border-radius:12px;
      display:grid;place-items:center;
    }
    .hamburger svg{width:22px;height:22px;stroke:var(--accent);stroke-width:2.6;fill:none}

    .wrap{max-width:980px;margin:0 auto;padding:14px}
    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
      -webkit-backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
      overflow:hidden;
    }
    .cardHead{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--border);
      display:flex;align-items:flex-start;gap:12px;
    }
    .cardHead h2{margin:0;font-size:30px;line-height:1.05;font-weight:1100}
    .cardHead p{margin:6px 0 0;color:var(--muted);font-weight:650}
    .badge{
      margin-left:auto;
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:999px;
      border:1.5px solid var(--borderStrong);
      background:rgba(255,255,255,.55);
      font-weight:900;
      white-space:nowrap;
    }
    .dot{width:10px;height:10px;border-radius:999px;background:#22c55e}
    .cardBody{padding:16px}

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .btn{
      height:48px;padding:0 16px;border-radius:999px;
      border:1.5px solid var(--borderStrong);
      background:var(--tile);
      font-weight:1000;cursor:pointer;
      display:inline-flex;align-items:center;gap:10px;
    }
    .btn.primary{border-color:var(--accent); color:var(--accent); background:rgba(255,149,0,.10)}
    .btn svg{width:18px;height:18px;stroke:currentColor;stroke-width:2.2;fill:none}

    .status{
      margin-top:12px;
      color:var(--muted);
      font-weight:750;
      font-size:13px;
      line-height:1.35;
      white-space:pre-line;
    }

    /* Sheet menu */
    #sheet{position:fixed;inset:0;display:none;z-index:9999}
    #sheet.open{display:block}
    #sheet .back{position:absolute;inset:0;background:rgba(0,0,0,.42)}
    #sheet .panel{
      position:absolute;right:0;top:0;height:100%;width:min(86vw,340px);
      background:rgba(255,255,255,.92);
      border-left:1px solid rgba(15,23,42,.18);
      padding:16px;
      transform:translateX(100%);
      transition:transform .22s ease-out;
      backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
      -webkit-backdrop-filter:blur(var(--glass-blur)) saturate(var(--glass-sat));
    }
    #sheet.open .panel{transform:translateX(0)}
    .sheetTitle{font-weight:1100;margin:0 0 10px}
    .sheetLink{
      display:block;padding:12px 12px;border-radius:14px;
      border:1px solid rgba(15,23,42,.10);
      background:rgba(255,255,255,.60);
      font-weight:900;
    }
  </style>

  <script>
    // HubSpot Conversations settings MUST be defined before loading the script.
    // Avoid inline styles is useful in some locked-down environments. (SDK docs)
    window.hsConversationsSettings = {
      loadImmediately: false,
      avoidInlineStyles: true
    };

    // SDK ready hook (official pattern)
    window.hsConversationsOnReady = [
      function() {
        setStatus("HubSpot ready ✅  Tap “Open chat”.");
        // Preload it (doesn't force open)
        try { window.HubSpotConversations.widget.load(); } catch (e) {}
      }
    ];

    function setStatus(msg){
      const el = document.getElementById("status");
      if (el) el.textContent = msg;
    }

    function openChat(){
      try{
        // Load + open (best reliability on iOS because it’s a user gesture)
        window.HubSpotConversations.widget.load({ widgetOpen: true });
        setStatus("Opening chat…");
      }catch(e){
        setStatus("Chat not available yet.\nTap Retry.\n\nIf this is iPhone-only: check Safari content blockers / DNS blocking.");
      }
    }

    function retry(){
      location.reload();
    }

    // Basic “blocked” detection (if the HubSpot loader never loads)
    window.addEventListener("load", () => {
      setTimeout(() => {
        if (!window.HubSpotConversations || !window.HubSpotConversations.widget) {
          setStatus(
            "HubSpot script did not load.\n\nMost common causes:\n• iOS Content Blocker / AdBlock DNS\n• Company network blocking trackers\n\nQuick test on this phone:\nopen https://js-na3.hs-scripts.com/342895404.js"
          );
        }
      }, 3500);
    });

    function sheetOpen(v){
      document.getElementById("sheet").classList.toggle("open", !!v);
    }
  </script>

  <!-- HubSpot loader -->
  <script async defer id="hs-script-loader" src="https://js-na3.hs-scripts.com/342895404.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="toprow">
      <div class="brand">
        <div class="logo">BFA</div>
        <h1>BFA Support</h1>
      </div>

      <button class="hamburger" aria-label="Menu" onclick="sheetOpen(true)">
        <svg viewBox="0 0 24 24">
          <path d="M4 7h16M4 12h16M4 17h16"></path>
        </svg>
      </button>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <div class="cardHead">
        <div style="min-width:0">
          <h2>Live Chat Support</h2>
          <p>We usually reply quickly during business hours.</p>
        </div>
        <div class="badge"><span class="dot"></span>Support Online</div>
      </div>

      <div class="cardBody">
        <div class="row">
          <button class="btn primary" onclick="openChat()">
            <svg viewBox="0 0 24 24"><path d="M21 15a4 4 0 0 1-4 4H8l-5 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg>
            Open chat
          </button>

          <button class="btn" onclick="retry()">
            <svg viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-3-6.7"/><path d="M21 3v7h-7"/></svg>
            Retry
          </button>
        </div>

        <div id="status" class="status">Loading HubSpot…</div>
      </div>
    </section>
  </main>

  <!-- Slide-in sheet -->
  <div id="sheet" onclick="sheetOpen(false)">
    <div class="back"></div>
    <div class="panel" onclick="event.stopPropagation()">
      <p class="sheetTitle">Menu</p>
      <a class="sheetLink" href="/" style="margin-bottom:10px;">Home</a>
      <a class="sheetLink" href="#" onclick="openChat(); return false;">Open chat</a>
    </div>
  </div>
</body>
</html>
